webpackJsonp([8],{k3DF:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a("p4Oo"),r=a.n(l),i=a("gs4M"),o=a.n(i),s=a("bZQ3"),n=a.n(s),c=a("FXHS"),u=a.n(c),m={name:"page-headline-list",data:function(){return{rules:{articleId:{required:!0,message:"请选择文章"},outUrl:{required:!0,message:"外部链接不能为空"},coverPhotoUrl:{required:!0,message:"请选择封面"},title:{required:!0,message:"标题名称不能为空"},terminal:{required:!0,message:"请选择发布终端"},appType:{required:!0,message:"请选择终端项目"},isUsed:{required:!0,message:"请选择是否启用"}},tableData:[],tableDataCount:0,searchForm:{pageSize:this.$config.PAGE_SIZE},isAdd:!0,dialogFormVisible:!1,form:{},loading:!1,tableLoading:!1,dialogTableVisible:!1}},components:{tableArticleList:a("e6Ue").a},methods:{getEnumTextByValue:function(e,t){return this.$Tool.getEnumTextByValue(e,t)},getSelectRow:function(e){this.$refs.form.resetFields(),this.$data.form.articleId=e.id,this.$data.form.articleName=e.title,this.$data.form.articleUrl=e.url,this.$data.form.title=e.title,this.$data.dialogTableVisible=!1},changeFormType:function(e){var t=this;this.$data.form.type=e,this.$data.form.articleId=null,this.$data.form.articleName="",this.$data.form.articleUrl="",this.$data.form.outUrl="",this.$nextTick(function(){t.submitForm()})},addTableList:function(){var e=this;this.$data.isAdd=!0,this.$data.dialogFormVisible=!0,this.$nextTick(function(){e.$refs.form.resetFields(),e.$data.form={type:1,articleId:null,articleName:"",outUrl:"",coverPhotoUrl:"",title:"",terminal:null,appType:[],isUsed:null}})},editTableList:function(e){var t=this;return u()(o.a.mark(function a(){var l;return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.$http.post("/article/articleList",{id:e.articleId});case 2:(l=a.sent).success&&(1===e.type&&(e.articleName=l.body.title),2===e.type&&(e.outUrl=e.url),t.$data.isAdd=!1,t.$data.dialogFormVisible=!0,t.$nextTick(function(){t.$refs.form.resetFields(),t.$data.form=n()({},e)}));case 4:case"end":return a.stop()}},a,t)}))()},deleteTableList:function(e){var t=this;this.$confirm('确认删除标题为"'+e.title+'"的头条？').then(u()(o.a.mark(function a(){return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.$http.post("/headline/headlineDelete",{id:e.id});case 2:a.sent.success&&(t.$notify.success({title:"提示",message:"删除成功"}),t.tableList());case 4:case"end":return a.stop()}},a,t)}))).catch(function(){})},searchTableList:function(){this.tableList()},tableList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return u()(o.a.mark(function a(){var l;return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return 2===e.$data.searchForm.terminal&&(e.$data.searchForm.appType=e.$data.searchForm.pcType),e.$data.tableLoading=!0,e.$data.searchForm.currentPage=t,a.next=5,e.$http.post("/headline/headlineList",r()({},e.$data.searchForm));case 5:l=a.sent,e.$data.tableLoading=!1,l.success&&(e.$data.tableDataCount=l.body.count,e.$data.tableData=l.body.rows);case 8:case"end":return a.stop()}},a,e)}))()},submitForm:function(){var e,t=this;this.$refs.form.validate((e=u()(o.a.mark(function e(a){var l,i;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=11;break}return t.$data.loading=!0,1===t.$data.form.type&&(t.$data.form.url=t.$data.form.articleUrl),2===t.$data.form.type&&(t.$data.form.url=t.$data.form.outUrl),t.$data.form.createrId=t.$userLogin.getLoginInfo().userId,l=t.$data.isAdd?"/headline/headlineAdd":"/headline/headlineModify",e.next=8,t.$http.post(l,r()({},t.$data.form));case 8:i=e.sent,t.$data.loading=!1,i.success&&(t.$data.dialogFormVisible=!1,t.$notify.success({title:"提示",message:t.$data.isAdd?"添加成功":"修改成功"}),t.tableList());case 11:case"end":return e.stop()}},e,t)})),function(t){return e.apply(this,arguments)}))},uploadSuccess:function(e){this.$data.form.coverPhotoUrl=e.data[0]}},mounted:function(){this.tableList()}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"page-headline-list"}},[a("div",{staticClass:"element-breadcrumb"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("router-link",{attrs:{to:"/index"}},[e._v("首页")])],1),e._v(" "),a("el-breadcrumb-item",[a("router-link",{attrs:{to:"/index/headlineList"}},[e._v("头条管理")])],1),e._v(" "),a("el-breadcrumb-item",[e._v("头条列表")])],1)],1),e._v(" "),a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.searchForm,size:"mini"}},[a("el-form-item",{attrs:{label:"标题"}},[a("el-input",{attrs:{placeholder:""},model:{value:e.searchForm.title,callback:function(t){e.$set(e.searchForm,"title",t)},expression:"searchForm.title"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"终端"}},[a("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"请选择"},model:{value:e.searchForm.terminal,callback:function(t){e.$set(e.searchForm,"terminal",t)},expression:"searchForm.terminal"}},[a("el-option",{attrs:{label:"全部",value:""}},[e._v("全部")]),e._v(" "),e._l(this.$Tool.getEnumData("TerminalTypeEnum"),function(e){return a("el-option",{key:e.value,attrs:{label:e.text,value:e.value}})})],2)],1),e._v(" "),1===e.searchForm.terminal?a("el-form-item",{attrs:{label:""}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.searchForm.appType,callback:function(t){e.$set(e.searchForm,"appType",t)},expression:"searchForm.appType"}},[a("el-option",{attrs:{label:"全部",value:""}},[e._v("全部")]),e._v(" "),e._l(this.$Tool.getEnumData("AppProcjectEnum"),function(t){return a("el-option",{key:t.value,attrs:{label:t.text,value:t.value}},[e._v(e._s(t.text))])})],2)],1):e._e(),e._v(" "),2===e.searchForm.terminal?a("el-form-item",{attrs:{label:""}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.searchForm.pcType,callback:function(t){e.$set(e.searchForm,"pcType",t)},expression:"searchForm.pcType"}},[a("el-option",{attrs:{label:"全部",value:""}},[e._v("全部")]),e._v(" "),e._l(this.$Tool.getEnumData("PcProcjetEnum"),function(t){return a("el-option",{key:t.value,attrs:{label:t.text,value:t.value}},[e._v(e._s(t.text))])})],2)],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"状态"}},[a("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"请选择"},model:{value:e.searchForm.isUsed,callback:function(t){e.$set(e.searchForm,"isUsed",t)},expression:"searchForm.isUsed"}},[a("el-option",{attrs:{label:"全部",value:""}},[e._v("全部")]),e._v(" "),e._l(this.$Tool.getEnumData("IsUsedEnum"),function(e){return a("el-option",{key:e.value,attrs:{label:e.text,value:e.value}})})],2)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.searchTableList}},[e._v("查询")])],1),e._v(" "),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.addTableList}},[e._v("添加")])],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],attrs:{data:e.tableData,border:"",height:this.$Tool.getTableHeight()}},[a("el-table-column",{attrs:{prop:"title",label:"标题",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{prop:"url",width:"180",label:"详情链接"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("a",{attrs:{target:"_blank",href:t.row.url}},[e._v(e._s(t.row.url))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"appType",width:"120",label:"发布终端"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.terminal?a("span",[e._v(e._s(e.getEnumTextByValue("AppProcjectEnum",t.row.appType)))]):e._e(),e._v(" "),2===t.row.terminal?a("span",[e._v(e._s(e.getEnumTextByValue("PcProcjetEnum",t.row.appType)))]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"gmtCreate",width:"160",label:"创建时间"}}),e._v(" "),a("el-table-column",{attrs:{prop:"gmtUpdate",width:"160",label:"更新时间"}}),e._v(" "),a("el-table-column",{attrs:{prop:"isUsed",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.getEnumTextByValue("IsUsedEnum",t.row.isUsed)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){e.editTableList(t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){e.deleteTableList(t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("el-pagination",{staticClass:"right",attrs:{layout:"total, prev, pager, next, jumper","current-page":this.$data.searchForm.currentPage,"page-size":this.$config.PAGE_SIZE,total:e.tableDataCount},on:{"current-change":e.tableList}}),e._v(" "),a("el-dialog",{attrs:{width:"700px",title:e.isAdd?"添加头条":"编辑头条",visible:e.dialogFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px",size:"mini"}},[1===e.form.type?a("el-form-item",{attrs:{label:"选择文章",prop:"articleId"}},[a("div",{staticStyle:{display:"flex"}},[a("el-input",{staticStyle:{"margin-right":"10px"},attrs:{disabled:"","auto-complete":"off"},model:{value:e.form.articleName,callback:function(t){e.$set(e.form,"articleName",t)},expression:"form.articleName"}}),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.form.articleId,expression:"form.articleId"}],attrs:{type:"hidden"},domProps:{value:e.form.articleId},on:{input:function(t){t.target.composing||e.$set(e.form,"articleId",t.target.value)}}}),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogTableVisible=!0}}},[e._v("选择")])],1)]):e._e(),e._v(" "),1===e.form.type?a("el-form-item",{attrs:{label:"外部链接",prop:""}},[a("div",{staticStyle:{display:"flex"}},[a("el-input",{staticStyle:{"margin-right":"10px"},attrs:{disabled:"","auto-complete":"off"},model:{value:e.form.outUrl,callback:function(t){e.$set(e.form,"outUrl",t)},expression:"form.outUrl"}}),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.changeFormType(2)}}},[e._v("使用")])],1)]):e._e(),e._v(" "),2===e.form.type?a("el-form-item",{attrs:{label:"外部链接",prop:"outUrl"}},[a("div",{staticStyle:{display:"flex"}},[a("el-input",{staticStyle:{"margin-right":"10px"},attrs:{"auto-complete":"off"},model:{value:e.form.outUrl,callback:function(t){e.$set(e.form,"outUrl",t)},expression:"form.outUrl"}}),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.changeFormType(1)}}},[e._v("不使用")])],1)]):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"封面",prop:"coverPhotoUrl"}},[a("el-upload",{attrs:{action:this.$config.HTTPOPENAPIURL+"/openapi/common/file/upload",headers:{appId:this.$config.HTTPHEADER_APPID,version:this.$config.HTTPHEADER_APPVERSION,sign:this.$config.HTTPHEADER_APPSIGN},data:{message:"{}"},name:"files","show-file-list":!1,"on-success":e.uploadSuccess}},[e.form.coverPhotoUrl?a("img",{attrs:{height:"90",src:e.form.coverPhotoUrl,alt:""}}):a("div",[a("el-button",{attrs:{size:"mini",type:"primary"}},[e._v("选择文件")])],1)])],1),e._v(" "),a("el-form-item",{attrs:{label:"标题名称",prop:"title"}},[a("el-input",{attrs:{placeholder:""},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"发布终端类型",prop:"terminal"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.terminal,callback:function(t){e.$set(e.form,"terminal",t)},expression:"form.terminal"}},e._l(this.$Tool.getEnumData("TerminalTypeEnum"),function(e){return a("el-option",{key:e.value,attrs:{label:e.text,value:e.value}})}))],1),e._v(" "),e.form.terminal?a("el-form-item",{attrs:{label:"终端项目",prop:"appType"}},[1===e.form.terminal?a("el-radio-group",{model:{value:e.form.appType,callback:function(t){e.$set(e.form,"appType",t)},expression:"form.appType"}},e._l(this.$Tool.getEnumData("AppProcjectEnum"),function(t){return a("el-radio",{key:t.value,attrs:{label:t.value}},[e._v(e._s(t.text))])})):e._e(),e._v(" "),2===e.form.terminal?a("el-radio-group",{model:{value:e.form.appType,callback:function(t){e.$set(e.form,"appType",t)},expression:"form.appType"}},e._l(this.$Tool.getEnumData("PcProcjetEnum"),function(t){return a("el-radio",{key:t.value,attrs:{label:t.value}},[e._v(e._s(t.text))])})):e._e()],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"是否启用",prop:"isUsed"}},[a("el-radio-group",{model:{value:e.form.isUsed,callback:function(t){e.$set(e.form,"isUsed",t)},expression:"form.isUsed"}},e._l(this.$Tool.getEnumData("IsUsedEnum"),function(t){return a("el-radio",{key:t.value,attrs:{name:"type",label:t.value,value:t.value}},[e._v("\n            "+e._s(t.text)+"\n          ")])}))],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.submitForm}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{width:"900px",title:"选择文章",visible:e.dialogTableVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[a("table-article-list",{attrs:{selectTable:!0},on:{"on-select":e.getSelectRow}})],1)],1)},staticRenderFns:[]},p=a("jadU")(m,d,!1,null,null,null);t.default=p.exports}});
//# sourceMappingURL=8.612c4ff0f7b3477765df.js.map