webpackJsonp([6],{Hdsn:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=r("gs4M"),i=r.n(a),o=r("FXHS"),s=r.n(o),n={name:"pageAdvert",components:{Editor:r("zL8o").a},data:function(){return{rules:{location:[{required:!0,message:"请选择广告位置",trigger:"change"}],title:[{required:!0,message:"请输入标题",trigger:"blur"}],imageUrl:[{required:!0,message:"请上传图片",trigger:"change"}],content:[{required:!0,message:"请输入内容",trigger:"blur"}],isUsed:[{required:!0,message:"请选择是否开启",trigger:"change"}],url:[{required:!0,message:"请输入外链接",trigger:"blur"}]},isouturl:!0,imageUrl:"",isAdd:!0,loading:!1,Form:{id:"",location:"",title:"",imageUrl:"",url:"",content:"",isUsed:"",createrId:this.$userLogin.getLoginInfo().userId,existLocationId:"",isOutUrl:1,autoUrl:""},dialogFormVisible:!1,tableData:[],formadvert:{title:"",isUsed:""}}},methods:{changIsUrl:function(t){this.$data.Form.isOutUrl=t,this.$data.Form.url=""},resetForm:function(){this.$refs.Form.resetFields(),this.$data.dialogFormVisible=!1},onSubmit:function(){var t=this;return s()(i.a.mark(function e(){var r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$http.post("/advert/advertFind",t.$data.formadvert);case 2:(r=e.sent).success&&(t.$data.tableData=r.body);case 4:case"end":return e.stop()}},e,t)}))()},onAdvertAdd:function(){var t=this;this.$data.isAdd=!0,this.$data.dialogFormVisible=!0,this.$nextTick(function(){t.$refs.Form.resetFields()})},handleAvatarSuccess:function(t,e){this.$data.Form.imageUrl=e.response.body.url},beforeAvatarUpload:function(t){var e="image/jpeg"===t.type||"image/png",r=t.size/1024/1024<5;return e||this.$message.error("上传头像图片格式不正确!"),r||this.$message.error("上传头像图片大小不能超过 2MB!"),e&&r},editorContent:function(t){this.$data.Form.content=t},handleSee:function(t){window.open(t.row.url)},handleEdit:function(t,e){var r=this;e&&(this.$data.isAdd=!1,this.$data.dialogFormVisible=!0,this.$nextTick(s()(i.a.mark(function t(){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r.$refs.Form.resetFields(),t.next=3,r.$http.get("/advert/advertList",{id:e});case 3:(a=t.sent).success&&(r.$data.Form=a.body);case 5:case"end":return t.stop()}},t,r)}))))},submitForm:function(){var t=this;return s()(i.a.mark(function e(){var r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.$data.loading=!0,r=t.$data.isAdd?"/advert/advertAdd":"/advert/advertUpdate",!t.$data.Form.existLocationId){e.next=6;break}return e.next=5,t.$http.post("/advert/advertUpdateLocation",{location:t.$data.Form.existLocationId,isUsed:2});case 5:e.sent;case 6:return"2"==t.$data.Form.isOutUrl&&(t.$data.Form.autoUrl=window.location.origin+"/#/index/advertDetail?noaction=true&id="),e.next=9,t.$http.post(r,t.$data.Form);case 9:e.sent.success&&(t.$data.dialogFormVisible=!1,t.$data.Form.isOutUrl=1,t.$notify.success({title:"提示",message:t.$data.isAdd?"添加成功":"修改成功"}),t.getAdvert()),t.$data.loading=!1;case 12:case"end":return e.stop()}},e,t)}))()},submitData:function(){var t,e=this;this.$refs.Form.validate((t=s()(i.a.mark(function t(r){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!r){t.next=5;break}return t.next=3,e.$http.get("/advert/existLocation",{location:e.$data.Form.location});case 3:(a=t.sent).success&&a.body?e.$confirm("该位置已经占用，是否覆盖？").then(function(){e.$data.Form.existLocationId=a.body.location,e.submitForm()}).catch(function(){}):e.submitForm();case 5:case"end":return t.stop()}},t,e)})),function(e){return t.apply(this,arguments)}))},getAdvert:function(){var t=this;return s()(i.a.mark(function e(){var r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$http.get("/advert/advertList",{});case 2:(r=e.sent).success&&(t.$data.tableData=r.body);case 4:case"end":return e.stop()}},e,t)}))()},handleDelete:function(t,e){var r=this;this.$confirm("确定删除此条数据吗？").then(s()(i.a.mark(function t(){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.$http.post("/advert/advertDelete",{id:e});case 2:(a=t.sent).success&&a.body&&(r.$notify({title:"提示",message:"删除成功！",type:"success"}),r.getAdvert());case 4:case"end":return t.stop()}},t,r)}))).catch(function(){r.$message({type:"info",message:"已取消删除"})})}},mounted:function(){this.getAdvert()}},l={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"page-advert"}},[r("div",{staticClass:"element-breadcrumb"},[r("el-breadcrumb",{attrs:{separator:"/"}},[r("el-breadcrumb-item",{attrs:{to:{path:"/index"}}},[t._v("首页")]),t._v(" "),r("el-breadcrumb-item",{attrs:{to:{path:"/advert"}}},[t._v("广告管理")]),t._v(" "),r("el-breadcrumb-item",[t._v("广告列表")])],1)],1),t._v(" "),r("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.formadvert}},[r("el-form-item",{attrs:{label:""}},[r("el-input",{attrs:{size:"medium",placeholder:"搜索标题"},model:{value:t.formadvert.title,callback:function(e){t.$set(t.formadvert,"title",e)},expression:"formadvert.title"}})],1),t._v(" "),r("el-form-item",{attrs:{label:""}},[r("el-select",{attrs:{size:"medium",placeholder:"选择状态"},model:{value:t.formadvert.isUsed,callback:function(e){t.$set(t.formadvert,"isUsed",e)},expression:"formadvert.isUsed"}},t._l(t.isUsed,function(t){return r("el-option",{key:t.val,attrs:{label:t.name,value:t.val}})}))],1),t._v(" "),r("el-form-item",[r("el-button",{attrs:{size:"medium",type:"primary"},on:{click:t.onSubmit}},[t._v("搜索")])],1),t._v(" "),r("el-form-item",[r("el-button",{attrs:{size:"medium"},on:{click:t.onAdvertAdd}},[t._v("新增")])],1)],1),t._v(" "),r("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,border:""}},[r("el-table-column",{attrs:{prop:"location",label:"位置",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("span",{staticStyle:{"margin-left":"10px"}},[t._v("位置"+t._s(e.row.location))])]}}])}),t._v(" "),r("el-table-column",{attrs:{prop:"title",label:"标题",width:"300"}}),t._v(" "),r("el-table-column",{attrs:{prop:"url",label:"链接"}}),t._v(" "),r("el-table-column",{attrs:{prop:"isUsed",label:"状态",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("span",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(1==e.row.isUsed?"启用":"禁止"))])]}}])}),t._v(" "),r("el-table-column",{attrs:{prop:"id",label:"操作",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.isUsed?r("div",[r("el-button",{attrs:{size:"mini",type:"warning"},on:{click:function(r){t.handleSee(e,e.row.id)}}},[t._v("查看\n          ")]),t._v(" "),r("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(r){t.handleEdit(e,e.row.id)}}},[t._v("编辑\n          ")])],1):r("div",[r("el-button",{attrs:{size:"mini",type:"warning"},on:{click:function(r){t.handleSee(e.row,e.row.id)}}},[t._v("查看\n          ")]),t._v(" "),r("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(r){t.handleDelete(e.$index,e.row.id)}}},[t._v("删除\n          ")])],1)]}}])})],1),t._v(" "),r("el-dialog",{attrs:{title:t.isAdd?"广告页添加":"广告页修改",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[r("el-form",{ref:"Form",staticClass:"demo-ruleForm",attrs:{size:"medium",model:t.Form,"label-width":"80px",rules:t.rules}},[r("el-form-item",{attrs:{label:"位置",prop:"location"}},[r("el-select",{attrs:{size:"medium",placeholder:"请选择位置"},model:{value:t.Form.location,callback:function(e){t.$set(t.Form,"location",e)},expression:"Form.location"}},[r("el-option",{attrs:{label:"1",value:"1"}}),t._v(" "),r("el-option",{attrs:{label:"2",value:"2"}}),t._v(" "),r("el-option",{attrs:{label:"3",value:"2"}})],1)],1),t._v(" "),r("el-form-item",{attrs:{label:"标题",prop:"title"}},[r("el-input",{attrs:{size:"medium",placeholder:"请输入标题"},model:{value:t.Form.title,callback:function(e){t.$set(t.Form,"title",e)},expression:"Form.title"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"上传图片",prop:"imageUrl"}},[r("el-upload",{staticClass:"avatar-uploader",attrs:{action:this.$config.HTTPBOSSURL+"/common/upload","show-file-list":!1,"on-success":t.handleAvatarSuccess,"before-upload":t.beforeAvatarUpload}},[t.Form.imageUrl?r("img",{staticClass:"avatar",attrs:{src:t.Form.imageUrl}}):r("i",{staticClass:"el-icon-plus  avatar-uploader-icon"})])],1),t._v(" "),1==t.Form.isOutUrl||""==t.Form.isOutUrl?r("el-form-item",{attrs:{label:"外链URL",prop:"url"}},[r("el-input",{staticStyle:{width:"89%"},attrs:{size:"medium",placeholder:"请输入URL"},model:{value:t.Form.url,callback:function(e){t.$set(t.Form,"url",e)},expression:"Form.url"}}),t._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(e){t.changIsUrl(2)}}},[t._v(" 不使用")])],1):t._e(),t._v(" "),2==t.Form.isOutUrl?r("el-form-item",{attrs:{label:"外链URL",prop:""}},[r("el-input",{staticStyle:{width:"89%"},attrs:{size:"medium",disabled:2==t.Form.isOutUrl,placeholder:"请输入URL"}}),t._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(e){t.changIsUrl(1)}}},[t._v("使用")])],1):t._e(),t._v(" "),2==t.Form.isOutUrl?r("el-form-item",{attrs:{label:"内容",prop:"content"}},[t.isAdd?r("editor",{on:{change:t.editorContent}}):r("editor",{attrs:{"editor-content":t.Form.content},on:{change:t.editorContent}})],1):t._e(),t._v(" "),r("el-form-item",{attrs:{label:"是否启用",prop:"isUsed"}},[r("el-radio-group",{model:{value:t.Form.isUsed,callback:function(e){t.$set(t.Form,"isUsed",e)},expression:"Form.isUsed"}},t._l(this.$Tool.getEnumData("IsUsedEnum"),function(e){return r("el-radio",{key:e.value,attrs:{name:"type",label:e.value,value:e.value}},[t._v("\n            "+t._s(e.text)+"\n          ")])}))],1)],1),t._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{size:"medium"},on:{click:function(e){t.resetForm("Form")}}},[t._v("取 消")]),t._v(" "),r("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:function(e){t.submitData("Form")}}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var d=r("jadU")(n,l,!1,function(t){r("lK19")},"data-v-3b02c6ed",null);e.default=d.exports},lK19:function(t,e){}});
//# sourceMappingURL=6.0d2bdec1b2c10743c37a.js.map